redis中为了实现高可用（High Availability，简称HA），采用了如下两个方式：

主从复制数据。
采用哨兵监控数据节点的运行情况，一旦主节点出现问题由从节点顶上继续进行服务。

主从复制
redis中主从节点复制数据有全量复制和部分复制之分。

旧版本全量复制功能的实现
全量复制使用snyc命令来实现，其流程是：

从服务器向主服务器发送sync命令。
主服务器在收到sync命令之后，调用bgsave命令生成最新的rdb文件，将这个文件同步给从服务器，这样从服务器载入这个rdb文件之后，状态就会和主服务器执行bgsave命令时候的一致。
主服务器将保存在命令缓冲区中的写命令同步给从服务器，从服务器执行这些命令，这样从服务器的状态就跟主服务器当前状态一致了。

旧版本全量复制功能，其最大的问题是从服务器断线重连时，即便在从服务器上已经有一部分数据了，也需要进行全量复制，这样做的效率很低，于是新版本的redis在这部分做了改进。

新版本全量复制功能的实现
新版本redis使用psync命令来代替sync命令，该命令既可以实现完整全同步也可以实现部分同步。

复制偏移量
执行复制的双方，主从服务器，分别会维护一个复制偏移量：

主服务器每次向从服务器同步了N字节数据之后，将修改自己的复制偏移量+N。
从服务器每次从主服务器同步了N字节数据之后，将修改自己的复制偏移量+N。

复制积压缓冲区
主服务器内部维护了一个固定长度的先进先出队列做为复制积压缓冲区，其默认大小为1MB。

在主服务器进行命令传播时，不仅会将写命令同步到从服务器，还会将写命令写入复制积压缓冲区。



每个redis服务器，都有其运行ID，运行ID由服务器在启动时自动生成，主服务器会将自己的运行ID发送给从服务器，而从服务器会将主服务器的运行ID保存起来。
从服务器redis断线重连之后进行同步时，就是根据运行ID来判断同步的进度：
如果从服务器上面保存的主服务器运行ID与当前主服务器运行ID一致，则认为这一次断线重连连接的是之前复制的主服务器，主服务器可以继续尝试部分同步操作。
否则，如果前后两次主服务器运行ID不相同，则认为是完成全同步流程。